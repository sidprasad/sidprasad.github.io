<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <title>Zoomable Image</title>
    <style>
        #svg-container {
            width: 100%;
            overflow: hidden;
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #zoomable-image {
            width: 100%;
            height: auto;
        }

        .svg-border {
            border: 2px solid black;
        }
    </style>
    <!-- Include D3.js library -->
    <script src="https://d3js.org/d3.v6.min.js"></script>
</head>

<body>

    <div class="container">


        <div class="container-fluid" id="svg-container">
            <svg id="diagram" width="800" height="800" class="svg-border">
                <g class="zoomable">

                    <g
                        transform="matrix(0.8516136641838226,0,0,0.8516136641838226,40.212697006184136,-36.65671889648752)">
                        <g id="">
                            <defs>
                                <marker id="arrow-10-[#333]" viewBox="0 0 10 10" refX="0" refY="5" markerWidth="10"
                                    markerHeight="10" markerUnits="userSpaceOnUse" orient="auto" fill="#333">
                                    <path d="M 0 0 L 10 5 L 0 10 z"></path>
                                </marker>
                            </defs>
                            <g class="nodes">
                                <g id="Pear0" transform="translate(-200 0)">
                                    <rect x="-50" y="-30" width="100" height="60"
                                        style="stroke: rgb(0, 158, 76); stroke-width: 1; fill: rgb(255, 255, 255);">
                                    </rect><text x="0" y="0" dy="0.33em"
                                        style="font-family: monospace; font-size: 14px; text-anchor: middle; user-select: none; fill: rgb(51, 51, 51);">Pear0</text>
                                </g>
                                <g id="Pear1" transform="translate(-400 0)">
                                    <rect x="-50" y="-30" width="100" height="60"
                                        style="stroke: rgb(0, 158, 76); stroke-width: 1; fill: rgb(255, 255, 255);">
                                    </rect><text x="0" y="0" dy="0.33em"
                                        style="font-family: monospace; font-size: 14px; text-anchor: middle; user-select: none; fill: rgb(51, 51, 51);">Pear1</text>
                                </g>
                                <g id="Pear2" transform="translate(-1200 0)">
                                    <rect x="-50" y="-30" width="100" height="60"
                                        style="stroke: rgb(0, 158, 76); stroke-width: 1; fill: rgb(255, 255, 255);">
                                    </rect><text x="0" y="0" dy="0.33em"
                                        style="font-family: monospace; font-size: 14px; text-anchor: middle; user-select: none; fill: rgb(51, 51, 51);">Pear2</text>
                                </g>
                                <g id="Fresh0" transform="translate(-900 160)">
                                    <rect x="-50" y="-30" width="100" height="60"
                                        style="stroke: rgb(152, 147, 6); stroke-width: 1; fill: rgb(255, 255, 255);">
                                    </rect><text x="0" y="0" dy="0.33em"
                                        style="font-family: monospace; font-size: 14px; text-anchor: middle; user-select: none; fill: rgb(51, 51, 51);">Fresh0</text>
                                </g>
                                <g id="Apple0" transform="translate(-600 0)">
                                    <rect x="-50" y="-30" width="100" height="60"
                                        style="stroke: rgb(230, 25, 25); stroke-width: 1; fill: rgb(255, 255, 255);">
                                    </rect><text x="0" y="0" dy="0.33em"
                                        style="font-family: monospace; font-size: 14px; text-anchor: middle; user-select: none; fill: rgb(51, 51, 51);">Apple0</text>
                                </g>
                                <g id="Apple1" transform="translate(1200 0)">
                                    <rect x="-50" y="-30" width="100" height="60"
                                        style="stroke: rgb(230, 25, 25); stroke-width: 1; fill: rgb(255, 255, 255);">
                                    </rect><text x="0" y="0" dy="0.33em"
                                        style="font-family: monospace; font-size: 14px; text-anchor: middle; user-select: none; fill: rgb(51, 51, 51);">Apple1</text>
                                </g>
                                <g id="Apple2" transform="translate(1000 0)">
                                    <rect x="-50" y="-30" width="100" height="60"
                                        style="stroke: rgb(230, 25, 25); stroke-width: 1; fill: rgb(255, 255, 255);">
                                    </rect><text x="0" y="0" dy="0.33em"
                                        style="font-family: monospace; font-size: 14px; text-anchor: middle; user-select: none; fill: rgb(51, 51, 51);">Apple2</text>
                                </g>
                                <g id="Apple3" transform="translate(800 0)">
                                    <rect x="-50" y="-30" width="100" height="60"
                                        style="stroke: rgb(230, 25, 25); stroke-width: 1; fill: rgb(255, 255, 255);">
                                    </rect><text x="0" y="0" dy="0.33em"
                                        style="font-family: monospace; font-size: 14px; text-anchor: middle; user-select: none; fill: rgb(51, 51, 51);">Apple3</text>
                                </g>
                                <g id="Apple4" transform="translate(-800 0)">
                                    <rect x="-50" y="-30" width="100" height="60"
                                        style="stroke: rgb(230, 25, 25); stroke-width: 1; fill: rgb(255, 255, 255);">
                                    </rect><text x="0" y="0" dy="0.33em"
                                        style="font-family: monospace; font-size: 14px; text-anchor: middle; user-select: none; fill: rgb(51, 51, 51);">Apple4</text>
                                </g>
                                <g id="Rotten0" transform="translate(400 160)">
                                    <rect x="-50" y="-30" width="100" height="60"
                                        style="stroke: rgb(252, 79, 229); stroke-width: 1; fill: rgb(255, 255, 255);">
                                    </rect><text x="0" y="0" dy="0.33em"
                                        style="font-family: monospace; font-size: 14px; text-anchor: middle; user-select: none; fill: rgb(51, 51, 51);">Rotten0</text>
                                </g>
                                <g id="Basket0" transform="translate(-1000 -160)">
                                    <rect x="-50" y="-30" width="100" height="60"
                                        style="stroke: rgb(56, 56, 56); stroke-width: 1; fill: rgb(255, 255, 255);">
                                    </rect><text x="0" y="0" dy="0.33em"
                                        style="font-family: monospace; font-size: 14px; text-anchor: middle; user-select: none; fill: rgb(51, 51, 51);">Basket0</text>
                                </g>
                                <g id="Basket1" transform="translate(900 -160)">
                                    <rect x="-50" y="-30" width="100" height="60"
                                        style="stroke: rgb(56, 56, 56); stroke-width: 1; fill: rgb(255, 255, 255);">
                                    </rect><text x="0" y="0" dy="0.33em"
                                        style="font-family: monospace; font-size: 14px; text-anchor: middle; user-select: none; fill: rgb(51, 51, 51);">Basket1</text>
                                </g>
                                <g id="Basket2" transform="translate(-200 -160)">
                                    <rect x="-50" y="-30" width="100" height="60"
                                        style="stroke: rgb(56, 56, 56); stroke-width: 1; fill: rgb(255, 255, 255);">
                                    </rect><text x="0" y="0" dy="0.33em"
                                        style="font-family: monospace; font-size: 14px; text-anchor: middle; user-select: none; fill: rgb(51, 51, 51);">Basket2</text>
                                </g>
                                <g id="Banana0" transform="translate(600 0)">
                                    <rect x="-50" y="-30" width="100" height="60"
                                        style="stroke: rgb(216, 219, 41); stroke-width: 1; fill: rgb(255, 255, 255);">
                                    </rect><text x="0" y="0" dy="0.33em"
                                        style="font-family: monospace; font-size: 14px; text-anchor: middle; user-select: none; fill: rgb(51, 51, 51);">Banana0</text>
                                </g>
                                <g id="Banana1" transform="translate(400 0)">
                                    <rect x="-50" y="-30" width="100" height="60"
                                        style="stroke: rgb(216, 219, 41); stroke-width: 1; fill: rgb(255, 255, 255);">
                                    </rect><text x="0" y="0" dy="0.33em"
                                        style="font-family: monospace; font-size: 14px; text-anchor: middle; user-select: none; fill: rgb(51, 51, 51);">Banana1</text>
                                </g>
                                <g id="Banana2" transform="translate(200 0)">
                                    <rect x="-50" y="-30" width="100" height="60"
                                        style="stroke: rgb(216, 219, 41); stroke-width: 1; fill: rgb(255, 255, 255);">
                                    </rect><text x="0" y="0" dy="0.33em"
                                        style="font-family: monospace; font-size: 14px; text-anchor: middle; user-select: none; fill: rgb(51, 51, 51);">Banana2</text>
                                </g>
                                <g id="Banana3" transform="translate(-1000 0)">
                                    <rect x="-50" y="-30" width="100" height="60"
                                        style="stroke: rgb(216, 219, 41); stroke-width: 1; fill: rgb(255, 255, 255);">
                                    </rect><text x="0" y="0" dy="0.33em"
                                        style="font-family: monospace; font-size: 14px; text-anchor: middle; user-select: none; fill: rgb(51, 51, 51);">Banana3</text>
                                </g>
                                <g id="Banana4" transform="translate(0 0)">
                                    <rect x="-50" y="-30" width="100" height="60"
                                        style="stroke: rgb(216, 219, 41); stroke-width: 1; fill: rgb(255, 255, 255);">
                                    </rect><text x="0" y="0" dy="0.33em"
                                        style="font-family: monospace; font-size: 14px; text-anchor: middle; user-select: none; fill: rgb(51, 51, 51);">Banana4</text>
                                </g>
                            </g>
                            <g class="edges">
                                <g id="Basket<:fruit:Basket0->Apple4">
                                    <path marker-end="url(#arrow-10-[#333])"
                                        style="stroke: rgb(51, 51, 51); stroke-width: 1; fill: none;"
                                        d="M-950,-140L-925,-130C-900,-120,-850,-100,-825.0010375976562,-83.33333206176758C-800.0020751953125,-66.66666412353516,-800.004150390625,-53.33332824707031,-800.0051879882812,-46.66666030883789L-800.0062255859375,-39.99999237060547">
                                    </path>
                                    <path
                                        d="M-950,-140L-925,-130C-900,-120,-850,-100,-825,-81.66666666666667C-800,-63.333333333333336,-800,-46.666666666666664,-800,-38.333333333333336L-800,-30"
                                        stroke="transparent" stroke-width="11" fill="none"></path><text
                                        x="-858.5221557617188" y="-101.1412353515625" dy="0.33em"
                                        style="font-family: monospace; font-size: 12px; text-anchor: middle; user-select: none;">fruit</text>
                                </g>
                                <g id="Basket<:fruit:Basket0->Pear2">
                                    <path marker-end="url(#arrow-10-[#333])"
                                        style="stroke: rgb(51, 51, 51); stroke-width: 1; fill: none;"
                                        d="M-1050,-140L-1075,-130C-1100,-120,-1150,-100,-1174.9989624023438,-83.33332951863606C-1199.9979248046875,-66.66665903727214,-1199.995849609375,-53.33331807454427,-1199.9948120117188,-46.666647593180336L-1199.9937744140625,-39.999977111816406">
                                    </path>
                                    <path
                                        d="M-1050,-140L-1075,-130C-1100,-120,-1150,-100,-1175,-81.66666666666667C-1200,-63.333333333333336,-1200,-46.666666666666664,-1200,-38.333333333333336L-1200,-30"
                                        stroke="transparent" stroke-width="11" fill="none"></path><text
                                        x="-1141.4779052734375" y="-101.1412353515625" dy="0.33em"
                                        style="font-family: monospace; font-size: 12px; text-anchor: middle; user-select: none;">fruit</text>
                                </g>
                                <g id="Basket<:fruit:Basket1->Apple1">
                                    <path marker-end="url(#arrow-10-[#333])"
                                        style="stroke: rgb(51, 51, 51); stroke-width: 1; fill: none;"
                                        d="M950,-146.66666666666669L991.6666666666666,-135.55555555555557C1033.3333333333333,-124.44444444444446,1116.6666666666667,-102.22222222222223,1158.3316243489583,-84.44443554348416C1199.99658203125,-66.6666488647461,1199.9931640625,-53.33329772949219,1199.991455078125,-46.666622161865234L1199.98974609375,-39.99994659423828">
                                    </path>
                                    <path
                                        d="M950,-146.66666666666669L991.6666666666666,-135.55555555555557C1033.3333333333333,-124.44444444444446,1116.6666666666667,-102.22222222222223,1158.3333333333333,-82.77777777777779C1200,-63.333333333333336,1200,-46.666666666666664,1200,-38.333333333333336L1200,-30"
                                        stroke="transparent" stroke-width="11" fill="none"></path><text
                                        x="1090.200439453125" y="-107.64232635498047" dy="0.33em"
                                        style="font-family: monospace; font-size: 12px; text-anchor: middle; user-select: none;">fruit</text>
                                </g>
                                <g id="Basket<:fruit:Basket1->Apple2">
                                    <path marker-end="url(#arrow-10-[#333])"
                                        style="stroke: rgb(51, 51, 51); stroke-width: 1; fill: none;"
                                        d="M937.5,-130L947.9166666666666,-121.66666666666667C958.3333333333334,-113.33333333333333,979.1666666666666,-96.66666666666667,989.5828959147135,-81.66666666666667C999.9991251627604,-66.66666666666667,999.9982503255209,-53.333333333333336,999.997812906901,-46.666666666666664L999.9973754882812,-40">
                                    </path>
                                    <path
                                        d="M937.5,-130L947.9166666666666,-121.66666666666667C958.3333333333334,-113.33333333333333,979.1666666666666,-96.66666666666667,989.5833333333334,-80C1000,-63.333333333333336,1000,-46.666666666666664,1000,-38.333333333333336L1000,-30"
                                        stroke="transparent" stroke-width="11" fill="none"></path><text
                                        x="983.5548706054688" y="-88.35424041748047" dy="0.33em"
                                        style="font-family: monospace; font-size: 12px; text-anchor: middle; user-select: none;">fruit</text>
                                </g>
                                <g id="Basket<:fruit:Basket1->Apple3">
                                    <path marker-end="url(#arrow-10-[#333])"
                                        style="stroke: rgb(51, 51, 51); stroke-width: 1; fill: none;"
                                        d="M862.5,-130L852.0833333333334,-121.66666666666667C841.6666666666666,-113.33333333333333,820.8333333333334,-96.66666666666667,810.4171040852865,-81.6666653951009C800.0008748372396,-66.66666412353516,800.0017496744791,-53.33332824707031,800.002187093099,-46.66666030883789L800.0026245117188,-39.99999237060547">
                                    </path>
                                    <path
                                        d="M862.5,-130L852.0833333333334,-121.66666666666667C841.6666666666666,-113.33333333333333,820.8333333333334,-96.66666666666667,810.4166666666666,-80C800,-63.333333333333336,800,-46.666666666666664,800,-38.333333333333336L800,-30"
                                        stroke="transparent" stroke-width="11" fill="none"></path><text
                                        x="816.4451293945312" y="-88.35424041748047" dy="0.33em"
                                        style="font-family: monospace; font-size: 12px; text-anchor: middle; user-select: none;">fruit</text>
                                </g>
                                <g id="Basket<:fruit:Basket1->Banana4">
                                    <path marker-end="url(#arrow-10-[#333])"
                                        style="stroke: rgb(51, 51, 51); stroke-width: 1; fill: none;"
                                        d="M850,-155.55555555555554L708.3333333333334,-142.96296296296296C566.6666666666666,-130.37037037037035,283.3333333333333,-105.18518518518518,141.67250096363327,-85.92582229331687C0.011668593933184942,-66.66645940144856,0.023337187866369884,-53.33291880289713,0.029171484832962353,-46.66614850362142L0.035005781799554825,-39.9993782043457">
                                    </path>
                                    <path
                                        d="M850,-155.55555555555554L708.3333333333334,-142.96296296296296C566.6666666666666,-130.37037037037035,283.3333333333333,-105.18518518518518,141.66666666666666,-84.25925925925925C-4.736951571734001e-15,-63.333333333333336,-9.473903143468002e-15,-46.666666666666664,-1.1842378929335004e-14,-38.333333333333336L-1.4210854715202004e-14,-30"
                                        stroke="transparent" stroke-width="11" fill="none"></path><text
                                        x="414.4537048339844" y="-115.69161987304688" dy="0.33em"
                                        style="font-family: monospace; font-size: 12px; text-anchor: middle; user-select: none;">fruit</text>
                                </g>
                                <g id="Basket<:fruit:Basket2->Apple0">
                                    <path marker-end="url(#arrow-10-[#333])"
                                        style="stroke: rgb(51, 51, 51); stroke-width: 1; fill: none;"
                                        d="M-250,-149.99999999999997L-308.3333333333333,-138.33333333333331C-366.6666666666667,-126.66666666666664,-483.3333333333333,-103.33333333333333,-541.6642659505209,-84.99997774759929C-599.9951985677084,-66.66662216186523,-599.9903971354166,-53.33324432373047,-599.9879964192709,-46.666555404663086L-599.985595703125,-39.9998664855957">
                                    </path>
                                    <path
                                        d="M-250,-149.99999999999997L-308.3333333333333,-138.33333333333331C-366.6666666666667,-126.66666666666664,-483.3333333333333,-103.33333333333333,-541.6666666666666,-83.33333333333333C-600,-63.333333333333336,-600,-46.666666666666664,-600,-38.333333333333336L-600,-30"
                                        stroke="transparent" stroke-width="11" fill="none"></path><text
                                        x="-438.9523620605469" y="-110.79773712158203" dy="0.33em"
                                        style="font-family: monospace; font-size: 12px; text-anchor: middle; user-select: none;">fruit</text>
                                </g>
                                <g id="Basket<:fruit:Basket2->Banana0">
                                    <path marker-end="url(#arrow-10-[#333])"
                                        style="stroke: rgb(51, 51, 51); stroke-width: 1; fill: none;"
                                        d="M-150,-155L-25,-142.5C100,-130,350,-105,474.99485270182294,-85.83325640360515C599.9897054036459,-66.66651280721028,599.9794108072916,-53.33302561442057,599.9742635091146,-46.66628201802572L599.9691162109375,-39.99953842163086">
                                    </path>
                                    <path
                                        d="M-150,-155L-25,-142.5C100,-130,350,-105,475,-84.16666666666667C600,-63.333333333333336,600,-46.666666666666664,600,-38.333333333333336L600,-30"
                                        stroke="transparent" stroke-width="11" fill="none"></path><text
                                        x="235.9881591796875" y="-115.23196411132812" dy="0.33em"
                                        style="font-family: monospace; font-size: 12px; text-anchor: middle; user-select: none;">fruit</text>
                                </g>
                                <g id="Basket<:fruit:Basket2->Banana1">
                                    <path marker-end="url(#arrow-10-[#333])"
                                        style="stroke: rgb(51, 51, 51); stroke-width: 1; fill: none;"
                                        d="M-150,-153.33333333333334L-58.333333333333336,-141.11111111111111C33.333333333333336,-128.88888888888889,216.66666666666666,-104.44444444444446,308.3295542399089,-85.55550850762262C399.99244181315106,-66.66657257080078,399.98488362630206,-53.33314514160156,399.9811045328776,-46.66643142700195L399.9773254394531,-39.999717712402344">
                                    </path>
                                    <path
                                        d="M-150,-153.33333333333334L-58.333333333333336,-141.11111111111111C33.333333333333336,-128.88888888888889,216.66666666666666,-104.44444444444446,308.3333333333333,-83.8888888888889C400,-63.333333333333336,400,-46.666666666666664,400,-38.333333333333336L400,-30"
                                        stroke="transparent" stroke-width="11" fill="none"></path><text
                                        x="137.15711975097656" y="-113.8083724975586" dy="0.33em"
                                        style="font-family: monospace; font-size: 12px; text-anchor: middle; user-select: none;">fruit</text>
                                </g>
                                <g id="Basket<:fruit:Basket2->Banana2">
                                    <path marker-end="url(#arrow-10-[#333])"
                                        style="stroke: rgb(51, 51, 51); stroke-width: 1; fill: none;"
                                        d="M-150,-150L-91.66666666666667,-138.33333333333334C-33.333333333333336,-126.66666666666667,83.33333333333333,-103.33333333333333,141.6642583211263,-84.9999828338623C199.99518330891928,-66.66663233439128,199.99036661783853,-53.333264668782554,199.9879582722982,-46.66658083597819L199.9855499267578,-39.99989700317383">
                                    </path>
                                    <path
                                        d="M-150,-150L-91.66666666666667,-138.33333333333334C-33.333333333333336,-126.66666666666667,83.33333333333333,-103.33333333333333,141.66666666666666,-83.33333333333333C200,-63.333333333333336,200,-46.666666666666664,200,-38.333333333333336L200,-30"
                                        stroke="transparent" stroke-width="11" fill="none"></path><text
                                        x="38.95246505737305" y="-110.79842376708984" dy="0.33em"
                                        style="font-family: monospace; font-size: 12px; text-anchor: middle; user-select: none;">fruit</text>
                                </g>
                                <g id="Basket<:fruit:Basket2->Banana3">
                                    <path marker-end="url(#arrow-10-[#333])"
                                        style="stroke: rgb(51, 51, 51); stroke-width: 1; fill: none;"
                                        d="M-250,-155L-375,-142.5C-500,-130,-750,-105,-874.9948425292969,-85.83325640360515C-999.9896850585938,-66.66651280721028,-999.9793701171875,-53.33302561442057,-999.9742126464844,-46.66628201802572L-999.9690551757812,-39.99953842163086">
                                    </path>
                                    <path
                                        d="M-250,-155L-375,-142.5C-500,-130,-750,-105,-875,-84.16666666666667C-1000,-63.333333333333336,-1000,-46.666666666666664,-1000,-38.333333333333336L-1000,-30"
                                        stroke="transparent" stroke-width="11" fill="none"></path><text
                                        x="-635.9881591796875" y="-115.23196411132812" dy="0.33em"
                                        style="font-family: monospace; font-size: 12px; text-anchor: middle; user-select: none;">fruit</text>
                                </g>
                                <g id="Basket<:fruit:Basket2->Pear0">
                                    <path marker-end="url(#arrow-10-[#333])"
                                        style="stroke: rgb(51, 51, 51); stroke-width: 1; fill: none;"
                                        d="M-200,-130L-200,-121.66666666666667C-200,-113.33333333333333,-200,-96.66666666666667,-200,-81.66666730244954C-200,-66.66666793823242,-200,-53.333335876464844,-200,-46.666669845581055L-200,-40.000003814697266">
                                    </path>
                                    <path
                                        d="M-200,-130L-200,-121.66666666666667C-200,-113.33333333333333,-200,-96.66666666666667,-200,-80C-200,-63.333333333333336,-200,-46.666666666666664,-200,-38.333333333333336L-200,-30"
                                        stroke="transparent" stroke-width="11" fill="none"></path><text x="-200" y="-80"
                                        dy="0.33em"
                                        style="font-family: monospace; font-size: 12px; text-anchor: middle; user-select: none;">fruit</text>
                                </g>
                                <g id="Basket<:fruit:Basket2->Pear1">
                                    <path marker-end="url(#arrow-10-[#333])"
                                        style="stroke: rgb(51, 51, 51); stroke-width: 1; fill: none;"
                                        d="M-250,-140L-275,-130C-300,-120,-350,-100,-374.99896748860675,-83.33332951863606C-399.99793497721356,-66.66665903727214,-399.99586995442706,-53.33331807454427,-399.9948374430339,-46.666647593180336L-399.9938049316406,-39.999977111816406">
                                    </path>
                                    <path
                                        d="M-250,-140L-275,-130C-300,-120,-350,-100,-375,-81.66666666666667C-400,-63.333333333333336,-400,-46.666666666666664,-400,-38.333333333333336L-400,-30"
                                        stroke="transparent" stroke-width="11" fill="none"></path><text
                                        x="-341.4782409667969" y="-101.14209747314453" dy="0.33em"
                                        style="font-family: monospace; font-size: 12px; text-anchor: middle; user-select: none;">fruit</text>
                                </g>
                                <g id="Fruit<:status:Apple0->Fresh0">
                                    <path marker-end="url(#arrow-10-[#333])"
                                        style="stroke: rgb(51, 51, 51); stroke-width: 1; fill: none;"
                                        d="M-600,30L-600,38.333333333333336C-600,46.666666666666664,-600,63.333333333333336,-640.0562744140625,82.3483403523763C-680.112548828125,101.36334737141927,-760.22509765625,122.72669474283855,-800.2813720703125,133.4083684285482L-840.337646484375,144.0900421142578">
                                    </path>
                                    <path
                                        d="M-600,30L-600,38.333333333333336C-600,46.666666666666664,-600,63.333333333333336,-641.6666666666666,82.77777777777779C-683.3333333333334,102.22222222222223,-766.6666666666666,124.44444444444446,-808.3333333333334,135.55555555555557L-850,146.66666666666669"
                                        stroke="transparent" stroke-width="11" fill="none"></path><text
                                        x="-709.7996215820312" y="107.64232635498047" dy="0.33em"
                                        style="font-family: monospace; font-size: 12px; text-anchor: middle; user-select: none;">status</text>
                                </g>
                                <g id="Fruit<:status:Apple1->Rotten0">
                                    <path marker-end="url(#arrow-10-[#333])"
                                        style="stroke: rgb(51, 51, 51); stroke-width: 1; fill: none;"
                                        d="M1200,30L1200,38.333333333333336C1200,46.666666666666664,1200,63.333333333333336,1076.6583964029949,84.00082651774089C953.3167928059896,104.66831970214844,706.6335856119791,129.33663940429688,583.291982014974,141.6707992553711L459.95037841796875,154.0049591064453">
                                    </path>
                                    <path
                                        d="M1200,30L1200,38.333333333333336C1200,46.666666666666664,1200,63.333333333333336,1075,84.16666666666667C950,105,700,130,575,142.5L450,155"
                                        stroke="transparent" stroke-width="11" fill="none"></path><text
                                        x="835.988037109375" y="115.2295913696289" dy="0.33em"
                                        style="font-family: monospace; font-size: 12px; text-anchor: middle; user-select: none;">status</text>
                                </g>
                                <g id="Fruit<:status:Apple2->Rotten0">
                                    <path marker-end="url(#arrow-10-[#333])"
                                        style="stroke: rgb(51, 51, 51); stroke-width: 1; fill: none;"
                                        d="M1000,30L1000,38.333333333333336C1000,46.666666666666664,1000,63.333333333333336,909.9853820800781,83.66861470540364C819.9707641601562,104.00389607747395,639.9415283203125,128.0077921549479,549.9269104003906,140.0097401936849L459.91229248046875,152.01168823242188">
                                    </path>
                                    <path
                                        d="M1000,30L1000,38.333333333333336C1000,46.666666666666664,1000,63.333333333333336,908.3333333333334,83.88888888888889C816.6666666666666,104.44444444444444,633.3333333333334,128.88888888888889,541.6666666666666,141.1111111111111L450,153.33333333333331"
                                        stroke="transparent" stroke-width="11" fill="none"></path><text
                                        x="737.1571044921875" y="113.8083724975586" dy="0.33em"
                                        style="font-family: monospace; font-size: 12px; text-anchor: middle; user-select: none;">status</text>
                                </g>
                                <g id="Fruit<:status:Apple3->Rotten0">
                                    <path marker-end="url(#arrow-10-[#333])"
                                        style="stroke: rgb(51, 51, 51); stroke-width: 1; fill: none;"
                                        d="M800,30L800,38.333333333333336C800,46.666666666666664,800,63.333333333333336,743.3009694417318,83.00647226969402C686.6019388834635,102.67961120605469,573.2038777669271,125.35922241210938,516.5048472086588,136.69902801513672L459.8058166503906,148.03883361816406">
                                    </path>
                                    <path
                                        d="M800,30L800,38.333333333333336C800,46.666666666666664,800,63.333333333333336,741.6666666666666,83.33333333333333C683.3333333333334,103.33333333333333,566.6666666666666,126.66666666666667,508.3333333333333,138.33333333333334L450,150"
                                        stroke="transparent" stroke-width="11" fill="none"></path><text
                                        x="638.952392578125" y="110.79774475097656" dy="0.33em"
                                        style="font-family: monospace; font-size: 12px; text-anchor: middle; user-select: none;">status</text>
                                </g>
                                <g id="Fruit<:status:Apple4->Fresh0">
                                    <path marker-end="url(#arrow-10-[#333])"
                                        style="stroke: rgb(51, 51, 51); stroke-width: 1; fill: none;"
                                        d="M-800,30L-800,38.333333333333336C-800,46.666666666666664,-800,63.333333333333336,-809.1152140299479,78.95884195963542C-818.2304280598959,94.5843505859375,-836.4608561197916,109.168701171875,-845.5760701497396,116.46087646484375L-854.6912841796875,123.7530517578125">
                                    </path>
                                    <path
                                        d="M-800,30L-800,38.333333333333336C-800,46.666666666666664,-800,63.333333333333336,-810.4166666666666,80C-820.8333333333334,96.66666666666667,-841.6666666666666,113.33333333333333,-852.0833333333334,121.66666666666667L-862.5,130"
                                        stroke="transparent" stroke-width="11" fill="none"></path><text
                                        x="-816.4451293945312" y="88.35424041748047" dy="0.33em"
                                        style="font-family: monospace; font-size: 12px; text-anchor: middle; user-select: none;">status</text>
                                </g>
                                <g id="Fruit<:status:Banana0->Rotten0">
                                    <path marker-end="url(#arrow-10-[#333])"
                                        style="stroke: rgb(51, 51, 51); stroke-width: 1; fill: none;"
                                        d="M600,30L600,38.333333333333336C600,46.666666666666664,600,63.333333333333336,576.5474599202474,81.0476811726888C553.0949198404948,98.76202901204427,506.18983968098956,117.52405802408855,482.737299601237,126.90507253011067L459.2847595214844,136.2860870361328">
                                    </path>
                                    <path
                                        d="M600,30L600,38.333333333333336C600,46.666666666666664,600,63.333333333333336,575,81.66666666666667C550,100,500,120,475,130L450,140"
                                        stroke="transparent" stroke-width="11" fill="none"></path><text
                                        x="541.4782104492188" y="101.14208984375" dy="0.33em"
                                        style="font-family: monospace; font-size: 12px; text-anchor: middle; user-select: none;">status</text>
                                </g>
                                <g id="Fruit<:status:Banana1->Rotten0">
                                    <path marker-end="url(#arrow-10-[#333])"
                                        style="stroke: rgb(51, 51, 51); stroke-width: 1; fill: none;"
                                        d="M400,30L400,38.333333333333336C400,46.666666666666664,400,63.333333333333336,400,78.33333333333333C400,93.33333333333333,400,106.66666666666667,400,113.33333333333333L400,120">
                                    </path>
                                    <path
                                        d="M400,30L400,38.333333333333336C400,46.666666666666664,400,63.333333333333336,400,80C400,96.66666666666667,400,113.33333333333333,400,121.66666666666667L400,130"
                                        stroke="transparent" stroke-width="11" fill="none"></path><text x="400" y="80"
                                        dy="0.33em"
                                        style="font-family: monospace; font-size: 12px; text-anchor: middle; user-select: none;">status</text>
                                </g>
                                <g id="Fruit<:status:Banana2->Rotten0">
                                    <path marker-end="url(#arrow-10-[#333])"
                                        style="stroke: rgb(51, 51, 51); stroke-width: 1; fill: none;"
                                        d="M200,30L200,38.333333333333336C200,46.666666666666664,200,63.333333333333336,223.4525400797526,81.0476811726888C246.90508015950522,98.76202901204427,293.81016031901044,117.52405802408855,317.262700398763,126.90507253011067L340.7152404785156,136.2860870361328">
                                    </path>
                                    <path
                                        d="M200,30L200,38.333333333333336C200,46.666666666666664,200,63.333333333333336,225,81.66666666666667C250,100,300,120,325,130L350,140"
                                        stroke="transparent" stroke-width="11" fill="none"></path><text
                                        x="258.52178955078125" y="101.14209747314453" dy="0.33em"
                                        style="font-family: monospace; font-size: 12px; text-anchor: middle; user-select: none;">status</text>
                                </g>
                                <g id="Fruit<:status:Banana3->Fresh0">
                                    <path marker-end="url(#arrow-10-[#333])"
                                        style="stroke: rgb(51, 51, 51); stroke-width: 1; fill: none;"
                                        d="M-1000,30L-1000,38.333333333333336C-1000,46.666666666666664,-1000,63.333333333333336,-990.8847859700521,78.95884323120117C-981.7695719401041,94.58435312906902,-963.5391438802084,109.16870625813802,-954.4239298502604,116.46088282267253L-945.3087158203125,123.75305938720703">
                                    </path>
                                    <path
                                        d="M-1000,30L-1000,38.333333333333336C-1000,46.666666666666664,-1000,63.333333333333336,-989.5833333333334,80C-979.1666666666666,96.66666666666667,-958.3333333333334,113.33333333333333,-947.9166666666666,121.66666666666667L-937.5,130"
                                        stroke="transparent" stroke-width="11" fill="none"></path><text
                                        x="-983.5548706054688" y="88.35424041748047" dy="0.33em"
                                        style="font-family: monospace; font-size: 12px; text-anchor: middle; user-select: none;">status</text>
                                </g>
                                <g id="Fruit<:status:Banana4->Rotten0">
                                    <path marker-end="url(#arrow-10-[#333])"
                                        style="stroke: rgb(51, 51, 51); stroke-width: 1; fill: none;"
                                        d="M0,30L0,38.333333333333336C0,46.666666666666664,0,63.333333333333336,56.69903055826823,83.00647226969402C113.39806111653645,102.67961120605469,226.7961222330729,125.35922241210938,283.4951527913411,136.69902801513672L340.1941833496094,148.03883361816406">
                                    </path>
                                    <path
                                        d="M0,30L0,38.333333333333336C0,46.666666666666664,0,63.333333333333336,58.333333333333336,83.33333333333333C116.66666666666667,103.33333333333333,233.33333333333334,126.66666666666667,291.6666666666667,138.33333333333334L350,150"
                                        stroke="transparent" stroke-width="11" fill="none"></path><text
                                        x="161.04769897460938" y="110.79774475097656" dy="0.33em"
                                        style="font-family: monospace; font-size: 12px; text-anchor: middle; user-select: none;">status</text>
                                </g>
                                <g id="Fruit<:status:Pear0->Rotten0">
                                    <path marker-end="url(#arrow-10-[#333])"
                                        style="stroke: rgb(51, 51, 51); stroke-width: 1; fill: none;"
                                        d="M-200,30L-200,38.333333333333336C-200,46.666666666666664,-200,63.333333333333336,-109.98538208007812,83.66861470540364C-19.97076416015625,104.00389607747395,160.0584716796875,128.0077921549479,250.07308959960938,140.0097401936849L340.08770751953125,152.01168823242188">
                                    </path>
                                    <path
                                        d="M-200,30L-200,38.333333333333336C-200,46.666666666666664,-200,63.333333333333336,-108.33333333333333,83.88888888888889C-16.666666666666668,104.44444444444444,166.66666666666666,128.88888888888889,258.3333333333333,141.1111111111111L350,153.33333333333331"
                                        stroke="transparent" stroke-width="11" fill="none"></path><text
                                        x="62.842891693115234" y="113.8083724975586" dy="0.33em"
                                        style="font-family: monospace; font-size: 12px; text-anchor: middle; user-select: none;">status</text>
                                </g>
                                <g id="Fruit<:status:Pear1->Rotten0">
                                    <path marker-end="url(#arrow-10-[#333])"
                                        style="stroke: rgb(51, 51, 51); stroke-width: 1; fill: none;"
                                        d="M-400,30L-400,38.333333333333336C-400,46.666666666666664,-400,63.333333333333336,-276.6583964029948,84.00082651774089C-153.3167928059896,104.66831970214844,93.36641438802083,129.33663940429688,216.70801798502603,141.6707992553711L340.04962158203125,154.0049591064453">
                                    </path>
                                    <path
                                        d="M-400,30L-400,38.333333333333336C-400,46.666666666666664,-400,63.333333333333336,-275,84.16666666666667C-150,105,100,130,225,142.5L350,155"
                                        stroke="transparent" stroke-width="11" fill="none"></path><text
                                        x="-35.98817443847656" y="115.23196411132812" dy="0.33em"
                                        style="font-family: monospace; font-size: 12px; text-anchor: middle; user-select: none;">status</text>
                                </g>
                                <g id="Fruit<:status:Pear2->Fresh0">
                                    <path marker-end="url(#arrow-10-[#333])"
                                        style="stroke: rgb(51, 51, 51); stroke-width: 1; fill: none;"
                                        d="M-1200,30L-1200,38.333333333333336C-1200,46.666666666666664,-1200,63.333333333333336,-1159.9437255859375,82.3483403523763C-1119.887451171875,101.36334737141927,-1039.77490234375,122.72669474283855,-999.7186279296875,133.4083684285482L-959.662353515625,144.0900421142578">
                                    </path>
                                    <path
                                        d="M-1200,30L-1200,38.333333333333336C-1200,46.666666666666664,-1200,63.333333333333336,-1158.3333333333333,82.77777777777779C-1116.6666666666667,102.22222222222223,-1033.3333333333333,124.44444444444446,-991.6666666666666,135.55555555555557L-950,146.66666666666669"
                                        stroke="transparent" stroke-width="11" fill="none"></path><text
                                        x="-1090.200439453125" y="107.64231872558594" dy="0.33em"
                                        style="font-family: monospace; font-size: 12px; text-anchor: middle; user-select: none;">status</text>
                                </g>
                            </g>
                        </g>
                    </g>
                </g>
            </svg>
        </div>
    </div>
    <script>
        // Add zoom behavior
        const zoom = d3.zoom()
            .scaleExtent([0.1, 10]) // Set the zoom scale extent
            .on('zoom', zoomed);

        function zoomed(event) {
            d3.select('.zoomable').attr('transform', event.transform);
        }
        const diagram = d3.select('#diagram');
        diagram.call(zoom);


        // Select all nodes and make them draggable
        const nodes = d3.selectAll('.nodes g');

        function getNodePositions() {
            const positions = {};
            nodes.each(function () {
                const node = d3.select(this);
                const transform = node.attr('transform');
                const translate = transform.match(/translate\(([^, ]+)[, ]+([^)]+)\)/);
                if (translate) {
                    const x = parseFloat(translate[1]);
                    const y = parseFloat(translate[2]);
                    positions[node.attr('id')] = { x, y };
                }
            });
            console.log(positions);
            return positions;
        }

        // Store the initial positions of the nodes
        const nodePositions = getNodePositions();

        function getEdgeSourceAndTarget(edgeId) {
            // First find the id of the last : character and get the substring after it
            const byParts = edgeId.split(':');
            let rel = byParts[byParts.length - 1];

            const [sourceId, targetId] = rel.split('->');
            return { sourceId, targetId };
        }

        function updatePath(path, startX, startY, endX, endY) {
            const controlPoint1 = `${(startX + endX) / 2},${startY}`;
            const controlPoint2 = `${(startX + endX) / 2},${endY}`;
            const newD = `M${startX},${startY} C${controlPoint1},${controlPoint2},${endX},${endY}`;
            path.attr('d', newD);
        }

        function getIntersectionPoint(node, targetNode) {
            const dx = targetNode.x - node.x;
            const dy = targetNode.y - node.y;
            const absDx = Math.abs(dx);
            const absDy = Math.abs(dy);

            let x = node.x;
            let y = node.y;

            const halfWidth = 50;
            const halfHeight = 30;

            if (absDx > absDy) {
                x += dx > 0 ? halfWidth : -halfWidth;
                y += dy * (halfWidth / absDx);
            } else {
                x += dx * (halfHeight / absDy);
                y += dy > 0 ? halfHeight : -halfHeight;
            }

            return { x, y };
        }

        function updateEdges(nodeId) {
            const node = nodePositions[nodeId];
            // Update edges where the node is the source
            d3.selectAll(`g[id*=":${nodeId}->"]`).each(function () {
                const edge = d3.select(this);
                const edgeId = edge.attr('id');

                const { sourceId, targetId } = getEdgeSourceAndTarget(edgeId);
                //assert (sourceId === nodeId);

                const targetNode = nodePositions[targetId];
                const sourceIntersection = getIntersectionPoint(node, targetNode);
                const targetIntersection = getIntersectionPoint(targetNode, node);
                edge.select('path').each(function () {
                    updatePath(d3.select(this), sourceIntersection.x, sourceIntersection.y, targetIntersection.x, targetIntersection.y);
                });

                // Update the position of the label
                edge.select('text').attr('x', (sourceIntersection.x + targetIntersection.x) / 2)
                    .attr('y', (sourceIntersection.y + targetIntersection.y) / 2);
            });

            // Update edges where the node is the target
            d3.selectAll(`g[id*="->${nodeId}"]`).each(function () {
                const edge = d3.select(this);
                const edgeId = edge.attr('id');

                const { sourceId, targetId } = getEdgeSourceAndTarget(edgeId);
                //assert (targetId === nodeId);

                const sourceNode = nodePositions[sourceId];
                const sourceIntersection = getIntersectionPoint(sourceNode, node);
                const targetIntersection = getIntersectionPoint(node, sourceNode);
                edge.select('path').each(function () {
                    updatePath(d3.select(this), sourceIntersection.x, sourceIntersection.y, targetIntersection.x, targetIntersection.y);
                });

                // Update the position of the label
                edge.select('text').attr('x', (sourceIntersection.x + targetIntersection.x) / 2)
                    .attr('y', (sourceIntersection.y + targetIntersection.y) / 2);
            });
        }

        nodes
            .call(d3.drag()
                .on('start', dragStarted)
                .on('drag', dragged)
                .on('end', dragEnded));

        function dragStarted(event, d) {
            d3.select(this).raise().attr('stroke', 'black');
        }

        function dragged(event, d) {
            const nodeId = d3.select(this).attr('id');
            nodePositions[nodeId].x = event.x;
            nodePositions[nodeId].y = event.y;
            d3.select(this).attr('transform', `translate(${event.x}, ${event.y})`);
            updateEdges(nodeId); // Update the edges during the drag event
        }

        function dragEnded(event, d) {
            d3.select(this).attr('stroke', null);
        }



        /**** This bit ensures we zoom to fit ***/
        const bbox = d3.select('.zoomable').node().getBBox();
        const padding = 10; // Padding in pixels

        const viewBox = [
            bbox.x - padding,
            bbox.y - padding,
            bbox.width + 2 * padding,
            bbox.height + 2 * padding
        ].join(' ');


        const topSvg = d3.select("#diagram");
        topSvg.attr('viewBox', viewBox);
        /*************************************/

    </script>
</body>

</html>