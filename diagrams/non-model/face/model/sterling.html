<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <title>Zoomable Image</title>
    <style>
        #svg-container {
            width: 100%;
            overflow: hidden;
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #zoomable-image {
            width: 100%;
            height: auto;
        }

        .svg-border {
            border: 2px solid black;
        }
    </style>
    <!-- Include D3.js library -->
    <script src="https://d3js.org/d3.v6.min.js"></script>
</head>

<body>

    <div class="container">


        <div class="container-fluid" id="svg-container">
            <svg id="diagram" width="800" height="800" class="svg-border">
                <g class="zoomable">
                    <g
                        transform="matrix(0.7252458330245966,0,0,0.7252458330245966,81.56021717917432,-52.153453646603786)">
                        <g id="">
                            <defs>
                                <marker id="arrow-10-[#333]" viewBox="0 0 10 10" refX="0" refY="5" markerWidth="10"
                                    markerHeight="10" markerUnits="userSpaceOnUse" orient="auto" fill="#333">
                                    <path d="M 0 0 L 10 5 L 0 10 z"></path>
                                </marker>
                            </defs>
                            <g class="nodes">
                                <g id="Mouth" transform="translate(-135 400)">
                                    <rect x="-50" y="-30" width="100" height="60"
                                        style="stroke: rgb(0, 80, 240); stroke-width: 1; fill: rgb(255, 255, 255);">
                                    </rect><text x="0" y="0" dy="0.33em"
                                        style="font-family: monospace; font-size: 14px; text-anchor: middle; user-select: none; fill: rgb(51, 51, 51);">Mouth</text>
                                </g>
                                <g id="Nose" transform="translate(-35 240)">
                                    <rect x="-50" y="-30" width="100" height="60"
                                        style="stroke: rgb(36, 168, 0); stroke-width: 1; fill: rgb(255, 255, 255);">
                                    </rect><text x="0" y="0" dy="0.33em"
                                        style="font-family: monospace; font-size: 14px; text-anchor: middle; user-select: none; fill: rgb(51, 51, 51);">Nose</text>
                                </g>
                                <g id="Chin" transform="translate(-190 560)">
                                    <rect x="-50" y="-30" width="100" height="60"
                                        style="stroke: rgb(158, 108, 0); stroke-width: 1; fill: rgb(255, 255, 255);">
                                    </rect><text x="0" y="0" dy="0.33em"
                                        style="font-family: monospace; font-size: 14px; text-anchor: middle; user-select: none; fill: rgb(51, 51, 51);">Chin</text>
                                </g>
                                <g id="Face" transform="translate(-115 -560)">
                                    <rect x="-50" y="-30" width="100" height="60"
                                        style="stroke: rgb(51, 51, 51); stroke-width: 1; fill: rgb(255, 255, 255);">
                                    </rect><text x="0" y="0" dy="0.33em"
                                        style="font-family: monospace; font-size: 14px; text-anchor: middle; user-select: none; fill: rgb(51, 51, 51);">Face</text>
                                </g>
                                <g id="EyeBrowA" transform="translate(70 -240)">
                                    <rect x="-50" y="-30" width="100" height="60"
                                        style="stroke: rgb(87, 12, 228); stroke-width: 1; fill: rgb(255, 255, 255);">
                                    </rect><text x="0" y="0" dy="0.33em"
                                        style="font-family: monospace; font-size: 14px; text-anchor: middle; user-select: none; fill: rgb(51, 51, 51);">EyeBrowA</text>
                                </g>
                                <g id="EyeBrowB" transform="translate(-20 -80)">
                                    <rect x="-50" y="-30" width="100" height="60"
                                        style="stroke: rgb(87, 12, 228); stroke-width: 1; fill: rgb(255, 255, 255);">
                                    </rect><text x="0" y="0" dy="0.33em"
                                        style="font-family: monospace; font-size: 14px; text-anchor: middle; user-select: none; fill: rgb(51, 51, 51);">EyeBrowB</text>
                                </g>
                                <g id="Eye2" transform="translate(-10 80)">
                                    <rect x="-50" y="-30" width="100" height="60"
                                        style="stroke: rgb(228, 7, 7); stroke-width: 1; fill: rgb(255, 255, 255);">
                                    </rect><text x="0" y="0" dy="0.33em"
                                        style="font-family: monospace; font-size: 14px; text-anchor: middle; user-select: none; fill: rgb(51, 51, 51);">Eye2</text>
                                </g>
                                <g id="Eye1" transform="translate(190 -80)">
                                    <rect x="-50" y="-30" width="100" height="60"
                                        style="stroke: rgb(228, 7, 7); stroke-width: 1; fill: rgb(255, 255, 255);">
                                    </rect><text x="0" y="0" dy="0.33em"
                                        style="font-family: monospace; font-size: 14px; text-anchor: middle; user-select: none; fill: rgb(51, 51, 51);">Eye1</text>
                                </g>
                                <g id="Hair" transform="translate(-50 -400)">
                                    <rect x="-50" y="-30" width="100" height="60"
                                        style="stroke: rgb(179, 140, 0); stroke-width: 1; fill: rgb(255, 255, 255);">
                                    </rect><text x="0" y="0" dy="0.33em"
                                        style="font-family: monospace; font-size: 14px; text-anchor: middle; user-select: none; fill: rgb(51, 51, 51);">Hair</text>
                                </g>
                            </g>
                            <g class="edges">
                                <g id="Face<:parts:Face->EyeBrowA">
                                    <path marker-end="url(#arrow-10-[#333])"
                                        style="stroke: rgb(51, 51, 51); stroke-width: 1; fill: none;"
                                        d="M-65,-537.1428571428571L-44.166666666666664,-527.6190476190476C-23.333333333333332,-518.0952380952381,18.333333333333332,-499.04761904761904,39.166666666666664,-476.19047619047615C60,-453.3333333333333,60,-426.6666666666667,60,-400C60,-373.3333333333333,60,-346.6666666666667,60.83500671386719,-326.653803507487C61.670013427734375,-306.6409403483073,63.34002685546875,-293.28188069661456,64.17503356933594,-286.60235087076825L65.01004028320312,-279.9228210449219">
                                    </path>
                                    <path
                                        d="M-65,-537.1428571428571L-44.166666666666664,-527.6190476190476C-23.333333333333332,-518.0952380952381,18.333333333333332,-499.04761904761904,39.166666666666664,-476.19047619047615C60,-453.3333333333333,60,-426.6666666666667,60,-400C60,-373.3333333333333,60,-346.6666666666667,61.041666666666664,-325C62.08333333333332,-303.3333333333333,64.16666666666664,-286.6666666666667,65.20833333333331,-278.3333333333333L66.24999999999997,-270"
                                        stroke="transparent" stroke-width="11" fill="none"></path><text
                                        x="58.035274505615234" y="-436.0528869628906" dy="0.33em"
                                        style="font-family: monospace; font-size: 12px; text-anchor: middle; user-select: none;">parts</text>
                                </g>
                                <g id="Face<:parts:Face->Eye2">
                                    <path marker-end="url(#arrow-10-[#333])"
                                        style="stroke: rgb(51, 51, 51); stroke-width: 1; fill: none;"
                                        d="M-139.375,-530L-146.14583333333334,-521.6666666666666C-152.91666666666666,-513.3333333333334,-166.45833333333334,-496.6666666666667,-173.22916666666666,-475C-180,-453.3333333333333,-180,-426.6666666666667,-180,-400C-180,-373.3333333333333,-180,-346.6666666666667,-180,-320C-180,-293.3333333333333,-180,-266.6666666666667,-180,-240C-180,-213.33333333333334,-180,-186.66666666666666,-180,-160C-180,-133.33333333333334,-180,-106.66666666666667,-180,-80C-180,-53.333333333333336,-180,-26.666666666666668,-161.5080312093099,-4.6312306722005205C-143.01606241861978,17.404205322265625,-106.03212483723958,34.80841064453125,-87.54015604654948,43.51051330566406L-69.04818725585938,52.212615966796875">
                                    </path>
                                    <path
                                        d="M-139.375,-530L-146.14583333333334,-521.6666666666666C-152.91666666666666,-513.3333333333334,-166.45833333333334,-496.6666666666667,-173.22916666666666,-475C-180,-453.3333333333333,-180,-426.6666666666667,-180,-400C-180,-373.3333333333333,-180,-346.6666666666667,-180,-320C-180,-293.3333333333333,-180,-266.6666666666667,-180,-240C-180,-213.33333333333334,-180,-186.66666666666666,-180,-160C-180,-133.33333333333334,-180,-106.66666666666667,-180,-80C-180,-53.333333333333336,-180,-26.666666666666668,-160,-3.9215686274509785C-140,18.82352941176471,-100,37.64705882352942,-80,47.058823529411775L-60,56.47058823529413"
                                        stroke="transparent" stroke-width="11" fill="none"></path><text x="-180"
                                        y="-211.18560791015625" dy="0.33em"
                                        style="font-family: monospace; font-size: 12px; text-anchor: middle; user-select: none;">parts</text>
                                </g>
                                <g id="Face<:parts:Face->Nose">
                                    <path marker-end="url(#arrow-10-[#333])"
                                        style="stroke: rgb(51, 51, 51); stroke-width: 1; fill: none;"
                                        d="M-146.87499999999997,-530L-155.72916666666666,-521.6666666666666C-164.58333333333331,-513.3333333333334,-182.29166666666666,-496.6666666666667,-191.14583333333334,-475C-200,-453.3333333333333,-200,-426.6666666666667,-200,-400C-200,-373.3333333333333,-200,-346.6666666666667,-200,-320C-200,-293.3333333333333,-200,-266.6666666666667,-200,-240C-200,-213.33333333333334,-200,-186.66666666666666,-200,-160C-200,-133.33333333333334,-200,-106.66666666666667,-200,-80C-200,-53.333333333333336,-200,-26.666666666666668,-200,0C-200,26.666666666666668,-200,53.333333333333336,-200,80C-200,106.66666666666667,-200,133.33333333333334,-182.33302307128906,155.23247273763022C-164.66604614257812,177.1316121419271,-129.33209228515625,194.26322428385416,-111.66511535644531,202.82903035481772L-93.99813842773438,211.39483642578125">
                                    </path>
                                    <path
                                        d="M-146.87499999999997,-530L-155.72916666666666,-521.6666666666666C-164.58333333333331,-513.3333333333334,-182.29166666666666,-496.6666666666667,-191.14583333333334,-475C-200,-453.3333333333333,-200,-426.6666666666667,-200,-400C-200,-373.3333333333333,-200,-346.6666666666667,-200,-320C-200,-293.3333333333333,-200,-266.6666666666667,-200,-240C-200,-213.33333333333334,-200,-186.66666666666666,-200,-160C-200,-133.33333333333334,-200,-106.66666666666667,-200,-80C-200,-53.333333333333336,-200,-26.666666666666668,-200,0C-200,26.666666666666668,-200,53.333333333333336,-200,80C-200,106.66666666666667,-200,133.33333333333334,-180.83333333333334,155.95959595959596C-161.66666666666666,178.58585858585857,-123.33333333333333,197.17171717171718,-104.16666666666667,206.46464646464645L-85,215.75757575757575"
                                        stroke="transparent" stroke-width="11" fill="none"></path><text x="-200"
                                        y="-136.63070678710938" dy="0.33em"
                                        style="font-family: monospace; font-size: 12px; text-anchor: middle; user-select: none;">parts</text>
                                </g>
                                <g id="Face<:parts:Face->Mouth">
                                    <path marker-end="url(#arrow-10-[#333])"
                                        style="stroke: rgb(51, 51, 51); stroke-width: 1; fill: none;"
                                        d="M-154.375,-530L-165.3125,-521.6666666666666C-176.25,-513.3333333333334,-198.125,-496.6666666666667,-209.0625,-475C-220,-453.3333333333333,-220,-426.6666666666667,-220,-400C-220,-373.3333333333333,-220,-346.6666666666667,-220,-320C-220,-293.3333333333333,-220,-266.6666666666667,-220,-240C-220,-213.33333333333334,-220,-186.66666666666666,-220,-160C-220,-133.33333333333334,-220,-106.66666666666667,-220,-80C-220,-53.333333333333336,-220,-26.666666666666668,-220,0C-220,26.666666666666668,-220,53.333333333333336,-220,80C-220,106.66666666666667,-220,133.33333333333334,-220,160C-220,186.66666666666666,-220,213.33333333333334,-220,240C-220,266.6666666666667,-220,293.3333333333333,-212.359499613444,313.85772705078125C-204.71899922688803,334.3821207682292,-189.43799845377603,348.7642415364583,-181.79749806722006,355.95530192057294L-174.15699768066406,363.1463623046875">
                                    </path>
                                    <path
                                        d="M-154.375,-530L-165.3125,-521.6666666666666C-176.25,-513.3333333333334,-198.125,-496.6666666666667,-209.0625,-475C-220,-453.3333333333333,-220,-426.6666666666667,-220,-400C-220,-373.3333333333333,-220,-346.6666666666667,-220,-320C-220,-293.3333333333333,-220,-266.6666666666667,-220,-240C-220,-213.33333333333334,-220,-186.66666666666666,-220,-160C-220,-133.33333333333334,-220,-106.66666666666667,-220,-80C-220,-53.333333333333336,-220,-26.666666666666668,-220,0C-220,26.666666666666668,-220,53.333333333333336,-220,80C-220,106.66666666666667,-220,133.33333333333334,-220,160C-220,186.66666666666666,-220,213.33333333333334,-220,240C-220,266.6666666666667,-220,293.3333333333333,-211.14583333333334,315C-202.29166666666666,336.6666666666667,-184.58333333333334,353.3333333333333,-175.72916666666666,361.6666666666667L-166.875,370"
                                        stroke="transparent" stroke-width="11" fill="none"></path><text x="-220"
                                        y="-83.78561401367188" dy="0.33em"
                                        style="font-family: monospace; font-size: 12px; text-anchor: middle; user-select: none;">parts</text>
                                </g>
                                <g id="Face<:parts:Face->Hair">
                                    <path marker-end="url(#arrow-10-[#333])"
                                        style="stroke: rgb(51, 51, 51); stroke-width: 1; fill: none;"
                                        d="M-90.625,-530L-83.85416666666667,-521.6666666666666C-77.08333333333333,-513.3333333333334,-63.541666666666664,-496.6666666666667,-56.77111498514811,-481.6666666666667C-50.000563303629555,-466.6666666666667,-50.00112660725912,-453.3333333333333,-50.00140825907389,-446.6666666666667L-50.00168991088867,-440">
                                    </path>
                                    <path
                                        d="M-90.625,-530L-83.85416666666667,-521.6666666666666C-77.08333333333333,-513.3333333333334,-63.541666666666664,-496.6666666666667,-56.770833333333336,-480C-50,-463.3333333333333,-50.00000000000001,-446.6666666666667,-50.00000000000001,-438.3333333333333L-50.000000000000014,-430"
                                        stroke="transparent" stroke-width="11" fill="none"></path><text
                                        x="-58.744773864746094" y="-484.47467041015625" dy="0.33em"
                                        style="font-family: monospace; font-size: 12px; text-anchor: middle; user-select: none;">parts</text>
                                </g>
                                <g id="Face<:parts:Face->EyeBrowB">
                                    <path marker-end="url(#arrow-10-[#333])"
                                        style="stroke: rgb(51, 51, 51); stroke-width: 1; fill: none;"
                                        d="M-131.875,-530L-136.5625,-521.6666666666666C-141.25,-513.3333333333334,-150.625,-496.6666666666667,-155.3125,-475C-160,-453.3333333333333,-160,-426.6666666666667,-160,-400C-160,-373.3333333333333,-160,-346.6666666666667,-160,-320C-160,-293.3333333333333,-160,-266.6666666666667,-160,-240C-160,-213.33333333333334,-160,-186.66666666666666,-146.44707234700522,-165.58880360921225C-132.8941446940104,-144.5109405517578,-105.78828938802083,-129.02188110351562,-92.23536173502605,-121.27735137939453L-78.68243408203125,-113.53282165527344">
                                    </path>
                                    <path
                                        d="M-131.875,-530L-136.5625,-521.6666666666666C-141.25,-513.3333333333334,-150.625,-496.6666666666667,-155.3125,-475C-160,-453.3333333333333,-160,-426.6666666666667,-160,-400C-160,-373.3333333333333,-160,-346.6666666666667,-160,-320C-160,-293.3333333333333,-160,-266.6666666666667,-160,-240C-160,-213.33333333333334,-160,-186.66666666666666,-145,-164.76190476190476C-130,-142.85714285714286,-100,-125.71428571428571,-85,-117.14285714285712L-70,-108.57142857142857"
                                        stroke="transparent" stroke-width="11" fill="none"></path><text x="-160"
                                        y="-301.42791748046875" dy="0.33em"
                                        style="font-family: monospace; font-size: 12px; text-anchor: middle; user-select: none;">parts</text>
                                </g>
                                <g id="Face<:parts:Face->Chin">
                                    <path marker-end="url(#arrow-10-[#333])"
                                        style="stroke: rgb(51, 51, 51); stroke-width: 1; fill: none;"
                                        d="M-165,-536.4705882352941L-185,-527.0588235294118C-205,-517.6470588235294,-245,-498.8235294117647,-265,-476.078431372549C-285,-453.3333333333333,-285,-426.6666666666667,-285,-400C-285,-373.3333333333333,-285,-346.6666666666667,-285,-320C-285,-293.3333333333333,-285,-266.6666666666667,-285,-240C-285,-213.33333333333334,-285,-186.66666666666666,-285,-160C-285,-133.33333333333334,-285,-106.66666666666667,-285,-80C-285,-53.333333333333336,-285,-26.666666666666668,-285,0C-285,26.666666666666668,-285,53.333333333333336,-285,80C-285,106.66666666666667,-285,133.33333333333334,-285,160C-285,186.66666666666666,-285,213.33333333333334,-285,240C-285,266.6666666666667,-285,293.3333333333333,-285,320C-285,346.6666666666667,-285,373.3333333333333,-285,400C-285,426.6666666666667,-285,453.3333333333333,-276.37902069091797,473.9264424641927C-267.75804138183594,494.51955159505206,-250.51608276367188,509.0391031901042,-241.89510345458984,516.2988789876302L-233.2741241455078,523.5586547851562">
                                    </path>
                                    <path
                                        d="M-165,-536.4705882352941L-185,-527.0588235294118C-205,-517.6470588235294,-245,-498.8235294117647,-265,-476.078431372549C-285,-453.3333333333333,-285,-426.6666666666667,-285,-400C-285,-373.3333333333333,-285,-346.6666666666667,-285,-320C-285,-293.3333333333333,-285,-266.6666666666667,-285,-240C-285,-213.33333333333334,-285,-186.66666666666666,-285,-160C-285,-133.33333333333334,-285,-106.66666666666667,-285,-80C-285,-53.333333333333336,-285,-26.666666666666668,-285,0C-285,26.666666666666668,-285,53.333333333333336,-285,80C-285,106.66666666666667,-285,133.33333333333334,-285,160C-285,186.66666666666666,-285,213.33333333333334,-285,240C-285,266.6666666666667,-285,293.3333333333333,-285,320C-285,346.6666666666667,-285,373.3333333333333,-285,400C-285,426.6666666666667,-285,453.3333333333333,-275.1041666666667,475C-265.2083333333333,496.6666666666667,-245.4166666666667,513.3333333333334,-235.52083333333337,521.6666666666666L-225.62500000000006,530"
                                        stroke="transparent" stroke-width="11" fill="none"></path><text x="-285"
                                        y="-23.68548583984375" dy="0.33em"
                                        style="font-family: monospace; font-size: 12px; text-anchor: middle; user-select: none;">parts</text>
                                </g>
                                <g id="Face<:parts:Face->Eye1">
                                    <path marker-end="url(#arrow-10-[#333])"
                                        style="stroke: rgb(51, 51, 51); stroke-width: 1; fill: none;"
                                        d="M-65,-546.4406779661017L-24.166666666666668,-535.367231638418C16.666666666666668,-524.2937853107345,98.33333333333333,-502.14689265536725,139.16666666666666,-477.7401129943503C180,-453.3333333333333,180,-426.6666666666667,180,-400C180,-373.3333333333333,180,-346.6666666666667,180,-320C180,-293.3333333333333,180,-266.6666666666667,180,-240C180,-213.33333333333334,180,-186.66666666666666,180.8350041707357,-166.65380350748697C181.67000834147134,-146.64094034830728,183.34001668294272,-133.2818806966146,184.17502085367838,-126.60235087076823L185.01002502441406,-119.92282104492188">
                                    </path>
                                    <path
                                        d="M-65,-546.4406779661017L-24.166666666666668,-535.367231638418C16.666666666666668,-524.2937853107345,98.33333333333333,-502.14689265536725,139.16666666666666,-477.7401129943503C180,-453.3333333333333,180,-426.6666666666667,180,-400C180,-373.3333333333333,180,-346.6666666666667,180,-320C180,-293.3333333333333,180,-266.6666666666667,180,-240C180,-213.33333333333334,180,-186.66666666666666,181.04166666666666,-165C182.08333333333334,-143.33333333333334,184.16666666666666,-126.66666666666667,185.20833333333334,-118.33333333333333L186.25,-110"
                                        stroke="transparent" stroke-width="11" fill="none"></path><text
                                        x="179.9299774169922" y="-409.5631103515625" dy="0.33em"
                                        style="font-family: monospace; font-size: 12px; text-anchor: middle; user-select: none;">parts</text>
                                </g>
                                <g id="FacePart<:below:EyeBrowA->Eye1">
                                    <path marker-end="url(#arrow-10-[#333])"
                                        style="stroke: rgb(51, 51, 51); stroke-width: 1; fill: none;"
                                        d="M118.75,-210L132.29166666666666,-201.66666666666666C145.83333333333334,-193.33333333333334,172.91666666666666,-176.66666666666666,185.62286122639975,-161.65386072794595C198.3290557861328,-146.64105478922525,196.65811157226562,-133.28210957845053,195.82263946533203,-126.60263697306316L194.98716735839844,-119.92316436767578">
                                    </path>
                                    <path
                                        d="M118.75,-210L132.29166666666666,-201.66666666666666C145.83333333333334,-193.33333333333334,172.91666666666666,-176.66666666666666,185.41666666666666,-160C197.91666666666666,-143.33333333333334,195.83333333333334,-126.66666666666667,194.79166666666666,-118.33333333333333L193.75,-110"
                                        stroke="transparent" stroke-width="11" fill="none"></path><text
                                        x="174.7246551513672" y="-171.4849853515625" dy="0.33em"
                                        style="font-family: monospace; font-size: 12px; text-anchor: middle; user-select: none;">below</text>
                                </g>
                                <g id="FacePart<:below:Eye2->Nose">
                                    <path marker-end="url(#arrow-10-[#333])"
                                        style="stroke: rgb(51, 51, 51); stroke-width: 1; fill: none;"
                                        d="M-10,110L-10,118.33333333333333C-10,126.66666666666667,-10,143.33333333333334,-12.107112248738607,158.4091771443685C-14.214224497477213,173.48502095540366,-18.428448994954426,186.97004191080728,-20.535561243693035,193.71255238850912L-22.64267349243164,200.45506286621094">
                                    </path>
                                    <path
                                        d="M-10,110L-10,118.33333333333333C-10,126.66666666666667,-10,143.33333333333334,-12.604166666666664,160C-15.208333333333329,176.66666666666666,-20.416666666666657,193.33333333333334,-23.020833333333325,201.66666666666666L-25.624999999999986,210"
                                        stroke="transparent" stroke-width="11" fill="none"></path><text
                                        x="-12.729178428649902" y="160.78770446777344" dy="0.33em"
                                        style="font-family: monospace; font-size: 12px; text-anchor: middle; user-select: none;">below</text>
                                </g>
                                <g id="FacePart<:below:Nose->Mouth">
                                    <path marker-end="url(#arrow-10-[#333])"
                                        style="stroke: rgb(51, 51, 51); stroke-width: 1; fill: none;"
                                        d="M-35,270L-35,278.3333333333333C-35,286.6666666666667,-35,303.3333333333333,-44.11521911621094,318.95884195963544C-53.230438232421875,334.5843505859375,-71.46087646484375,349.168701171875,-80.57609558105469,356.46087646484375L-89.69131469726562,363.7530517578125">
                                    </path>
                                    <path
                                        d="M-35,270L-35,278.3333333333333C-35,286.6666666666667,-35,303.3333333333333,-45.416666666666664,320C-55.83333333333332,336.6666666666667,-76.66666666666664,353.3333333333333,-87.08333333333331,361.6666666666667L-97.49999999999997,370"
                                        stroke="transparent" stroke-width="11" fill="none"></path><text
                                        x="-51.4451789855957" y="328.3542175292969" dy="0.33em"
                                        style="font-family: monospace; font-size: 12px; text-anchor: middle; user-select: none;">below</text>
                                </g>
                                <g id="FacePart<:below:Mouth->Chin">
                                    <path marker-end="url(#arrow-10-[#333])"
                                        style="stroke: rgb(51, 51, 51); stroke-width: 1; fill: none;"
                                        d="M-135,430L-135,438.3333333333333C-135,446.6666666666667,-135,463.3333333333333,-139.78495025634766,478.62659708658856C-144.5699005126953,493.91986083984375,-154.13980102539062,507.8397216796875,-158.92475128173828,514.7996520996094L-163.70970153808594,521.7595825195312">
                                    </path>
                                    <path
                                        d="M-135,430L-135,438.3333333333333C-135,446.6666666666667,-135,463.3333333333333,-140.72916666666666,480C-146.45833333333334,496.6666666666667,-157.91666666666666,513.3333333333334,-163.64583333333334,521.6666666666666L-169.375,530"
                                        stroke="transparent" stroke-width="11" fill="none"></path><text
                                        x="-141.96987915039062" y="483.3867492675781" dy="0.33em"
                                        style="font-family: monospace; font-size: 12px; text-anchor: middle; user-select: none;">below</text>
                                </g>
                                <g id="FacePart<:below:Hair->EyeBrowA">
                                    <path marker-end="url(#arrow-10-[#333])"
                                        style="stroke: rgb(51, 51, 51); stroke-width: 1; fill: none;"
                                        d="M0,-375.75757575757575L19.166666666666668,-366.4646464646465C38.333333333333336,-357.17171717171715,76.66666666666667,-338.5858585858586,91.96288935343425,-322.412247937135C107.25911204020183,-306.23863728841144,99.51822408040364,-292.47727457682294,95.64778010050456,-285.5965932210286L91.77733612060547,-278.7159118652344">
                                    </path>
                                    <path
                                        d="M0,-375.75757575757575L19.166666666666668,-366.4646464646465C38.333333333333336,-357.17171717171715,76.66666666666667,-338.5858585858586,91.14583333333333,-320.95959595959596C105.625,-303.3333333333333,96.25,-286.6666666666667,91.56249999999999,-278.3333333333333L86.87499999999999,-270"
                                        stroke="transparent" stroke-width="11" fill="none"></path><text
                                        x="71.65447235107422" y="-337.61688232421875" dy="0.33em"
                                        style="font-family: monospace; font-size: 12px; text-anchor: middle; user-select: none;">below</text>
                                </g>
                                <g id="FacePart<:below:Hair->EyeBrowB">
                                    <path marker-end="url(#arrow-10-[#333])"
                                        style="stroke: rgb(51, 51, 51); stroke-width: 1; fill: none;"
                                        d="M-50,-370L-50,-361.6666666666667C-50,-353.3333333333333,-50,-336.6666666666667,-50,-315C-50,-293.3333333333333,-50,-266.6666666666667,-50,-240C-50,-213.33333333333334,-50,-186.66666666666666,-47.460095723470054,-166.5605926513672C-44.9201914469401,-146.45451863606772,-39.84038289388021,-132.9090372721354,-37.30047861735026,-126.13629659016927L-34.76057434082031,-119.36355590820312">
                                    </path>
                                    <path
                                        d="M-50,-370L-50,-361.6666666666667C-50,-353.3333333333333,-50,-336.6666666666667,-50,-315C-50,-293.3333333333333,-50,-266.6666666666667,-50,-240C-50,-213.33333333333334,-50,-186.66666666666666,-46.875,-165C-43.75,-143.33333333333334,-37.50000000000001,-126.66666666666667,-34.37500000000001,-118.33333333333333L-31.250000000000007,-110"
                                        stroke="transparent" stroke-width="11" fill="none"></path><text
                                        x="-49.999813079833984" y="-238.7797088623047" dy="0.33em"
                                        style="font-family: monospace; font-size: 12px; text-anchor: middle; user-select: none;">below</text>
                                </g>
                                <g id="FacePart<:below:EyeBrowB->Eye2">
                                    <path marker-end="url(#arrow-10-[#333])"
                                        style="stroke: rgb(51, 51, 51); stroke-width: 1; fill: none;"
                                        d="M-20,-50L-20,-41.666666666666664C-20,-33.333333333333336,-20,-16.666666666666668,-19.16501792271932,-1.6538009643554688C-18.33003584543864,13.359064737955729,-16.660071690877277,26.718129475911457,-15.825089613596598,33.39766184488932L-14.990107536315918,40.07719421386719">
                                    </path>
                                    <path
                                        d="M-20,-50L-20,-41.666666666666664C-20,-33.333333333333336,-20,-16.666666666666668,-18.958333333333336,0C-17.91666666666667,16.666666666666668,-15.833333333333343,33.333333333333336,-14.791666666666679,41.666666666666664L-13.750000000000014,50"
                                        stroke="transparent" stroke-width="11" fill="none"></path><text
                                        x="-18.950176239013672" y="0.12951889634132385" dy="0.33em"
                                        style="font-family: monospace; font-size: 12px; text-anchor: middle; user-select: none;">below</text>
                                </g>
                                <g id="FacePart<:below:Eye1->Nose">
                                    <path marker-end="url(#arrow-10-[#333])"
                                        style="stroke: rgb(51, 51, 51); stroke-width: 1; fill: none;"
                                        d="M193.75,-50L194.79166666666666,-41.666666666666664C195.83333333333334,-33.333333333333336,197.91666666666666,-16.666666666666668,198.95833333333334,5C200,26.666666666666668,200,53.333333333333336,200,80C200,106.66666666666667,200,133.33333333333334,170.7444165547689,156.62601470947266C141.48883310953775,179.91869608561197,82.97766621907552,199.83739217122397,53.7220827738444,209.79674021402994L24.46649932861328,219.75608825683594">
                                    </path>
                                    <path
                                        d="M193.75,-50L194.79166666666666,-41.666666666666664C195.83333333333334,-33.333333333333336,197.91666666666666,-16.666666666666668,198.95833333333334,5C200,26.666666666666668,200,53.333333333333336,200,80C200,106.66666666666667,200,133.33333333333334,169.16666666666666,157.1631205673759C138.33333333333334,180.99290780141845,76.66666666666667,201.98581560283685,45.833333333333336,212.48226950354606L15,222.97872340425528"
                                        stroke="transparent" stroke-width="11" fill="none"></path><text
                                        x="186.313232421875" y="139.7666473388672" dy="0.33em"
                                        style="font-family: monospace; font-size: 12px; text-anchor: middle; user-select: none;">below</text>
                                </g>
                                <g id="FacePart<:aligned:EyeBrowA->EyeBrowB">
                                    <path marker-end="url(#arrow-10-[#333])"
                                        style="stroke: rgb(51, 51, 51); stroke-width: 1; fill: none;"
                                        d="M70,-210L70,-201.66666666666666C70,-193.33333333333334,70,-176.66666666666666,61.870682080586754,-161.10727310180664C53.7413641611735,-145.54787953694662,37.48272832234701,-131.09575907389322,29.353410402933758,-123.86969884236653L21.224092483520508,-116.64363861083984">
                                    </path>
                                    <path
                                        d="M70,-210L70,-201.66666666666666C70,-193.33333333333334,70,-176.66666666666666,60.625,-160C51.24999999999999,-143.33333333333334,32.49999999999998,-126.66666666666667,23.124999999999975,-118.33333333333333L13.749999999999972,-110"
                                        stroke="transparent" stroke-width="11" fill="none"></path><text
                                        x="55.97401428222656" y="-152.72100830078125" dy="0.33em"
                                        style="font-family: monospace; font-size: 12px; text-anchor: middle; user-select: none;">aligned</text>
                                </g>
                                <g id="FacePart<:aligned:Eye1->Eye2">
                                    <path marker-end="url(#arrow-10-[#333])"
                                        style="stroke: rgb(51, 51, 51); stroke-width: 1; fill: none;"
                                        d="M156.25,-50L146.875,-41.666666666666664C137.5,-33.333333333333336,118.75,-16.666666666666668,99.26456006368001,-0.9802862803141276C79.77912012736003,14.706094106038412,59.558240254720054,29.412188212076824,49.44780031840006,36.76523526509603L39.33736038208008,44.118282318115234">
                                    </path>
                                    <path
                                        d="M156.25,-50L146.875,-41.666666666666664C137.5,-33.333333333333336,118.75,-16.666666666666668,97.91666666666667,0C77.08333333333333,16.666666666666668,54.16666666666665,33.333333333333336,42.708333333333314,41.666666666666664L31.24999999999997,50"
                                        stroke="transparent" stroke-width="11" fill="none"></path><text
                                        x="95.37408447265625" y="2.025742292404175" dy="0.33em"
                                        style="font-family: monospace; font-size: 12px; text-anchor: middle; user-select: none;">aligned</text>
                                </g>
                            </g>
                        </g>
                    </g>

                </g>
            </svg>
        </div>
    </div>
    <script>
        // Add zoom behavior
        const zoom = d3.zoom()
            .scaleExtent([0.1, 10]) // Set the zoom scale extent
            .on('zoom', zoomed);

        function zoomed(event) {
            d3.select('.zoomable').attr('transform', event.transform);
        }
        const diagram = d3.select('#diagram');
        diagram.call(zoom);


        // Select all nodes and make them draggable
        const nodes = d3.selectAll('.nodes g');

        function getNodePositions() {
            const positions = {};
            nodes.each(function () {
                const node = d3.select(this);
                const transform = node.attr('transform');
                const translate = transform.match(/translate\(([^, ]+)[, ]+([^)]+)\)/);
                if (translate) {
                    const x = parseFloat(translate[1]);
                    const y = parseFloat(translate[2]);
                    positions[node.attr('id')] = { x, y };
                }
            });
            console.log(positions);
            return positions;
        }

        // Store the initial positions of the nodes
        const nodePositions = getNodePositions();

        function getEdgeSourceAndTarget(edgeId) {
            // First find the id of the last : character and get the substring after it
            const byParts = edgeId.split(':');
            let rel = byParts[byParts.length - 1];

            const [sourceId, targetId] = rel.split('->');
            return { sourceId, targetId };
        }

        function updatePath(path, startX, startY, endX, endY) {
            const controlPoint1 = `${(startX + endX) / 2},${startY}`;
            const controlPoint2 = `${(startX + endX) / 2},${endY}`;
            const newD = `M${startX},${startY} C${controlPoint1},${controlPoint2},${endX},${endY}`;
            path.attr('d', newD);
        }

        function getIntersectionPoint(node, targetNode) {
            const dx = targetNode.x - node.x;
            const dy = targetNode.y - node.y;
            const absDx = Math.abs(dx);
            const absDy = Math.abs(dy);

            let x = node.x;
            let y = node.y;

            const halfWidth = 50;
            const halfHeight = 30;

            if (absDx > absDy) {
                x += dx > 0 ? halfWidth : -halfWidth;
                y += dy * (halfWidth / absDx);
            } else {
                x += dx * (halfHeight / absDy);
                y += dy > 0 ? halfHeight : -halfHeight;
            }

            return { x, y };
        }

        function updateEdges(nodeId) {
            const node = nodePositions[nodeId];
            // Update edges where the node is the source
            d3.selectAll(`g[id*=":${nodeId}->"]`).each(function () {
                const edge = d3.select(this);
                const edgeId = edge.attr('id');

                const { sourceId, targetId } = getEdgeSourceAndTarget(edgeId);
                //assert (sourceId === nodeId);

                const targetNode = nodePositions[targetId];
                const sourceIntersection = getIntersectionPoint(node, targetNode);
                const targetIntersection = getIntersectionPoint(targetNode, node);
                edge.select('path').each(function () {
                    updatePath(d3.select(this), sourceIntersection.x, sourceIntersection.y, targetIntersection.x, targetIntersection.y);
                });

                // Update the position of the label
                edge.select('text').attr('x', (sourceIntersection.x + targetIntersection.x) / 2)
                    .attr('y', (sourceIntersection.y + targetIntersection.y) / 2);
            });

            // Update edges where the node is the target
            d3.selectAll(`g[id*="->${nodeId}"]`).each(function () {
                const edge = d3.select(this);
                const edgeId = edge.attr('id');

                const { sourceId, targetId } = getEdgeSourceAndTarget(edgeId);
                //assert (targetId === nodeId);

                const sourceNode = nodePositions[sourceId];
                const sourceIntersection = getIntersectionPoint(sourceNode, node);
                const targetIntersection = getIntersectionPoint(node, sourceNode);
                edge.select('path').each(function () {
                    updatePath(d3.select(this), sourceIntersection.x, sourceIntersection.y, targetIntersection.x, targetIntersection.y);
                });

                // Update the position of the label
                edge.select('text').attr('x', (sourceIntersection.x + targetIntersection.x) / 2)
                    .attr('y', (sourceIntersection.y + targetIntersection.y) / 2);
            });
        }

        nodes
            .call(d3.drag()
                .on('start', dragStarted)
                .on('drag', dragged)
                .on('end', dragEnded));

        function dragStarted(event, d) {
            d3.select(this).raise().attr('stroke', 'black');
        }

        function dragged(event, d) {
            const nodeId = d3.select(this).attr('id');
            nodePositions[nodeId].x = event.x;
            nodePositions[nodeId].y = event.y;
            d3.select(this).attr('transform', `translate(${event.x}, ${event.y})`);
            updateEdges(nodeId); // Update the edges during the drag event
        }

        function dragEnded(event, d) {
            d3.select(this).attr('stroke', null);
        }



        /**** This bit ensures we zoom to fit ***/
        const bbox = d3.select('.zoomable').node().getBBox();
        const padding = 10; // Padding in pixels

        const viewBox = [
            bbox.x - padding,
            bbox.y - padding,
            bbox.width + 2 * padding,
            bbox.height + 2 * padding
        ].join(' ');


        const topSvg = d3.select("#diagram");
        topSvg.attr('viewBox', viewBox);
        /*************************************/

    </script>
</body>

</html>